<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Ch·ªën H·ªçc T·∫≠p ‚Äî KienDev_</title>
<link rel="icon" href="avatar.png">

<style>
:root{
  --bg:#030516;
  --card:#081225;
  --muted:#95a5c7;
  --accent1:#7C3AED;
  --accent2:#06B6D4;
  --pink1:#ffb86b;
  --pink2:#ff6bcb;
}
*{box-sizing:border-box}
body{
  margin:0;
  background:var(--bg);
  color:#eaf2ff;
  font-family:"Palatino Linotype","Book Antiqua",Palatino,serif;
}
.wrap{max-width:1200px;margin:auto;padding:20px}

/* ===== TOP ===== */
.top{display:flex;gap:16px;align-items:center;flex-wrap:wrap;padding:16px;border-radius:16px;background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.05)}
.avatar{width:64px;height:64px;border-radius:14px}
.title h1{margin:0;font-size:22px;letter-spacing:.5px}
.title p{margin:4px 0 0;color:var(--muted);font-size:13px}
.controls{margin-left:auto}
.search{padding:10px 14px;border-radius:12px;border:1px solid rgba(255,255,255,.1);background:rgba(255,255,255,.05);color:white}

/* ===== FILTERS ===== */
.filters{margin-top:18px;display:flex;gap:8px;flex-wrap:wrap}
.filters button{height:36px;padding:0 14px;border-radius:999px;border:1px solid rgba(255,255,255,.1);background:rgba(255,255,255,.06);color:white;cursor:pointer;font-size:13px}
.filters button.active{background:linear-gradient(90deg,var(--accent1),var(--accent2));font-weight:700}

/* ===== SECTIONS ===== */
.section{margin-top:22px}
.section h3{margin:0 0 10px;font-size:15px;color:var(--muted)}

/* ===== ROW ===== */
.row{display:flex;gap:16px;overflow-x:auto;padding-bottom:10px}
.row::-webkit-scrollbar{height:8px}
.row::-webkit-scrollbar-thumb{background:linear-gradient(90deg,var(--accent1),var(--accent2));border-radius:10px}

/* ===== GRID ===== */
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:18px}

/* ===== CARD ===== */
.card{padding:16px;border-radius:16px;background:linear-gradient(180deg,rgba(255,255,255,.04),transparent);border:1px solid rgba(255,255,255,.05);position:relative;transition:.2s}
.card:hover{transform:translateY(-6px)}

.top-badge{
  position:absolute;top:12px;left:12px;
  padding:4px 8px;font-size:11px;font-weight:700;
  border-radius:8px;
  background:linear-gradient(90deg,var(--pink1),var(--pink2));
  color:#071023;
  opacity:0;
  transform:translateY(-6px);
  transition:.2s
}
.card:hover .top-badge{opacity:1;transform:none}

.card-top{display:flex;gap:12px;align-items:center}
.file-icon{
  width:52px;height:52px;border-radius:12px;
  background:rgba(255,255,255,.08);
  display:flex;align-items:center;justify-content:center
}
.file-icon svg{width:32px;height:32px}

.name{font-weight:700;font-size:15px}
.sub{font-size:12px;color:var(--muted);margin-top:4px}

.actions{margin-top:14px;display:flex;gap:10px}
.btn-view{flex:1;padding:10px;border-radius:10px;border:0;font-weight:700;cursor:pointer;background:linear-gradient(90deg,#0ea5e9,#7c3aed);color:white}
.btn-dl{flex:1;padding:10px;border-radius:10px;font-weight:700;text-decoration:none;background:linear-gradient(90deg,var(--pink1),var(--pink2));color:#071023;display:flex;align-items:center;justify-content:center}

.desc-ellipsis{display:block;max-height:2.6em;overflow:hidden;text-overflow:ellipsis}
</style>
</head>
<body>
<div class="wrap">

  <div class="top">
    <img src="avatar.png" class="avatar">
    <div class="title">
      <h1>CH·ªêN H·ªåC T·∫¨P</h1>
      <p>Code by KienDev ‚Äî Xem & T·∫£i t√†i li·ªáu</p>
    </div>
    <div class="controls">
      <input id="q" class="search" placeholder="T√¨m m√£ ƒë·ªÅ, m√¥n, l·ªõp...">
    </div>
  </div>

  <div class="filters">
    <button class="active" onclick="setFilter('all',this)">T·∫•t c·∫£</button>
    <button onclick="setFilter('recent',this)">üÜï G·∫ßn ƒë√¢y</button>
    <button onclick="setFilter('10',this)">L·ªõp 10</button>
    <button onclick="setFilter('11',this)">L·ªõp 11</button>
    <button onclick="setFilter('12',this)">L·ªõp 12</button>
  </div>

  <div class="section">
    <h3 id="mainTitle">T·∫•t c·∫£</h3>
    <div id="grid" class="grid"></div>
  </div>

</div>

<script>
const owner="kientrng", repo="pages", folder="files";
const api=`https://api.github.com/repos/${owner}/${repo}/contents/${folder}`;

const grid=document.getElementById("grid");
const q=document.getElementById("q");
let all=[],current="all";

const clean = n => n.replace(/\.(docx?|pdf|png|jpe?g)$/i,"");
const extOf = n => (n.match(/\.([a-z0-9]+)$/i)||[])[1]||"";
const normalize=s=>s.normalize('NFD').replace(/[\u0300-\u036f]/g,'').toLowerCase();

function parse(f){
  const base = clean(f.name);
  const p = base.split('-');
  return {...f, grade:p[0]||'', num:p[1]||'', subject:p[2]||'', desc:p.slice(3).join('-')||'(kh√¥ng m√¥ t·∫£)'};
}

const sortDesc=(a,b)=>Number(b.grade)-Number(a.grade)||Number(b.num)-Number(a.num)||b.subject.localeCompare(a.subject,'vi');

const icons={
  toan:`<svg viewBox='0 0 24 24'><path fill='#3b82f6' d='M4 5h6v2H4zm0 4h6v2H4zm8-4h2v8h-2z'/></svg>`,
  ly:`<svg viewBox='0 0 24 24'><circle cx='12' cy='6' r='2' fill='#8b5cf6'/><ellipse cx='12' cy='12' rx='7' ry='3' fill='none' stroke='#8b5cf6' stroke-width='1.5'/></svg>`,
  hoa:`<svg viewBox='0 0 24 24'><path fill='#06b6d4' d='M6 3h12l-4 8v6H10v-6z'/></svg>`,
  def:`<svg viewBox='0 0 24 24'><rect x='6' y='3' width='12' height='18' rx='2' fill='#94a3b8'/></svg>`
};

function subjectIcon(s){
  s=normalize(s);
  if(s.includes('toan')) return icons.toan;
  if(s.includes('ly')||s.includes('li')) return icons.ly;
  if(s.includes('hoa')) return icons.hoa;
  return icons.def;
}

function card(f){
  const title=`${f.grade}-${f.num}-${f.subject}`;
  return `<div class='card'>
    <div class='top-badge'>${f.grade}</div>
    <div class='card-top'>
      <div class='file-icon'>${subjectIcon(f.subject)}</div>
      <div>
        <div class='name'>${title}</div>
        <div class='sub desc-ellipsis'>${f.desc}</div>
      </div>
    </div>
    <div class='actions'>
      <button class='btn-view' onclick="openView('${f.download_url}','${f.name}')">üëÅ Xem</button>
      <a class='btn-dl' href='${f.download_url}' download>‚¨á T·∫£i</a>
    </div>
  </div>`;
}

function render(list){grid.innerHTML=list.map(card).join('')||"<p>Kh√¥ng c√≥ k·∫øt qu·∫£</p>"}

function apply(){
  let list=[...all];
  const kw=q.value.trim().toLowerCase();
  if(kw) list=list.filter(f=>`${f.grade}-${f.num}-${f.subject}-${f.desc}`.toLowerCase().includes(kw));

  if(current==='recent'){
    grid.innerHTML=['12','11','10'].map(g=>{
      const items=list.filter(f=>f.grade==g).sort(sortDesc);
      if(!items.length) return '';
      return `<div class='section'><h3>L·ªõp ${g}</h3><div class='row'>${items.map(card).join('')}</div></div>`;
    }).join('');
    return;
  }

  if(['10','11','12'].includes(current)) list=list.filter(f=>f.grade==current);
  render(list.sort(sortDesc));
}

function setFilter(t,b){
  document.querySelectorAll('.filters button').forEach(x=>x.classList.remove('active'));
  b.classList.add('active');current=t;
  document.getElementById('mainTitle').innerText=b.innerText;
  apply();
}

q.oninput=apply;
function openView(u,n){location.href=`view.html?file=${encodeURIComponent(u)}&name=${encodeURIComponent(n)}`}

fetch(api).then(r=>r.json()).then(d=>{all=d.filter(x=>x.type==='file').map(parse);apply()});
</script>
</body>
</html>
