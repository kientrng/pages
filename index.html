<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>CH·ªêN H·ªåC T·∫¨P</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

<style>
body {
  margin: 0;
  font-family: Poppins, sans-serif;
  background: radial-gradient(circle at top, #0f1330, #060818);
  color: #fff;
}

.container {
  max-width: 1200px;
  margin: auto;
  padding: 24px;
}

.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: #0b1026;
  padding: 20px;
  border-radius: 18px;
}

.tabs {
  display: flex;
  gap: 12px;
  margin: 20px 0;
}

.tab {
  padding: 8px 16px;
  border-radius: 20px;
  background: #11163a;
  cursor: pointer;
  font-size: 14px;
}
.tab.active {
  background: linear-gradient(90deg,#6a7bff,#4dd6ff);
}

.section-title {
  margin: 20px 0 10px;
  font-weight: 600;
}

.recent {
  display: flex;
  gap: 16px;
  overflow-x: auto;
  padding-bottom: 10px;
}
.recent::-webkit-scrollbar { height: 6px; }
.recent::-webkit-scrollbar-thumb {
  background: linear-gradient(90deg,#6a7bff,#ff7ac8);
  border-radius: 4px;
}

.grid {
  display: grid;
  grid-template-columns: repeat(auto-fill,minmax(240px,1fr));
  gap: 16px;
}

.card {
  background: #0e1430;
  border-radius: 16px;
  padding: 16px;
}

.badge {
  background: #ff7ac8;
  font-size: 12px;
  padding: 2px 8px;
  border-radius: 10px;
  display: inline-block;
  margin-bottom: 6px;
}

.actions {
  display: flex;
  gap: 10px;
  margin-top: 12px;
}

.btn {
  flex: 1;
  text-align: center;
  padding: 8px;
  border-radius: 12px;
  cursor: pointer;
  font-size: 14px;
}

.btn-view {
  background: linear-gradient(90deg,#4dd6ff,#6a7bff);
}
.btn-download {
  background: linear-gradient(90deg,#ffb36a,#ff7ac8);
}
</style>
</head>

<body>
<div class="container">

  <div class="header">
    <div>
      <h2>CH·ªêN H·ªåC T·∫¨P</h2>
      <div style="font-size:14px;opacity:.8">Code by KienDev ‚Äî Xem & T·∫£i t√†i li·ªáu</div>
    </div>
  </div>

  <div class="tabs">
    <div class="tab active" id="tab-all">T·∫•t c·∫£</div>
    <div class="tab" id="tab-new">M·ªõi nh·∫•t</div>
  </div>

  <div class="section-title">File g·∫ßn ƒë√¢y</div>
  <div class="recent" id="recent"></div>

  <div class="section-title">T·∫•t c·∫£</div>
  <div class="grid" id="grid"></div>

</div>

<script>
const API = "https://api.github.com/repos/kientrng/pages/contents/files";
let allFiles = [];

function parse(name){
  const raw = name.replace(/\.(docx?|pdf|pptx?)$/i,"");
  const [lop, so, mon] = raw.split("-");
  return { lop:+lop||0, so:+so||0, mon:mon||"" };
}

function sortNewest(files){
  return [...files].sort((a,b)=>{
    const A=parse(a.name), B=parse(b.name);
    if(A.lop!==B.lop) return B.lop-A.lop;
    if(A.so!==B.so) return B.so-A.so;
    return B.mon.localeCompare(A.mon,"vi");
  });
}

function cardHTML(f){
  const info=parse(f.name);
  return `
  <div class="card">
    <div class="badge">${info.lop}</div>
    <div style="font-weight:600">${info.lop}-${info.so}-${info.mon}</div>
    <div style="opacity:.6;font-size:13px">(kh√¥ng m√¥ t·∫£)</div>
    <div class="actions">
      <div class="btn btn-view" onclick="view('${f.download_url}','${f.name}')">üëÅ Xem</div>
      <div class="btn btn-download" onclick="download('${f.download_url}')">‚¨á T·∫£i</div>
    </div>
  </div>`;
}

function renderGrid(files){
  grid.innerHTML = files.map(cardHTML).join("");
}

function renderRecent(files){
  recent.innerHTML = files.slice(0,6).map(cardHTML).join("");
}

function view(url,name){
  location.href = `view.html?file=${encodeURIComponent(url)}&name=${encodeURIComponent(name)}`;
}
function download(url){ window.open(url,"_blank"); }

fetch(API)
.then(r=>r.json())
.then(data=>{
  allFiles = data.filter(f=>f.type==="file");
  renderGrid(allFiles);
  renderRecent(sortNewest(allFiles));
});

tabAll.onclick=()=>{
  tabAll.classList.add("active");
  tabNew.classList.remove("active");
  renderGrid(allFiles);
};
tabNew.onclick=()=>{
  tabNew.classList.add("active");
  tabAll.classList.remove("active");
  renderGrid(sortNewest(allFiles));
};
</script>
</body>
</html>
