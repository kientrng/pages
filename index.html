<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Ch·ªën H·ªçc T·∫≠p ‚Äî KienDev_</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#030516;
  --muted:#95a5c7;
  --accent1:#7C3AED;
  --accent2:#06B6D4;
  --pink1:#ffb86b;
  --pink2:#ff6bcb;
  --card:#081225;
}
*{box-sizing:border-box;font-family:Poppins}
body{margin:0;background:var(--bg);color:#eaf2ff}
.wrap{max-width:1200px;margin:auto;padding:18px}

/* ===== Header ===== */
.top{
  display:flex;gap:14px;align-items:center;
  padding:16px;border-radius:14px;
  background:linear-gradient(180deg,rgba(255,255,255,.03),transparent);
  border:1px solid rgba(255,255,255,.04)
}
.avatar{width:64px;height:64px;border-radius:14px}
.title h1{margin:0;font-size:20px}
.title p{margin:4px 0 0;color:var(--muted);font-size:13px}
.controls{margin-left:auto}
.search{
  padding:10px 14px;border-radius:10px;
  background:rgba(255,255,255,.04);
  border:1px solid rgba(255,255,255,.06);
  color:white
}

/* ===== Categories ===== */
.section-row{margin-top:18px;display:flex;gap:10px;flex-wrap:wrap}
.pill{
  padding:8px 14px;border-radius:999px;
  background:rgba(255,255,255,.03);
  border:1px solid rgba(255,255,255,.04);
  color:var(--muted);font-weight:700;
  cursor:pointer;transition:.18s
}
.pill.active{
  background:linear-gradient(90deg,var(--accent1),var(--accent2));
  color:white;transform:translateY(-2px)
}

/* ===== Recent ===== */
.recent-wrap{margin-top:22px}
.recent-head{display:flex;justify-content:space-between;align-items:center}
.recent-track-wrap{overflow:hidden;margin-top:12px}
.recent-track{
  display:flex;gap:14px;
  transition:transform .45s cubic-bezier(.22,.9,.3,1)
}
.recent-card{
  min-width:280px;
  background:var(--card);
  padding:14px;border-radius:14px;
  border:1px solid rgba(255,255,255,.04);
  box-shadow:0 8px 30px rgba(0,0,0,.45)
}

/* ===== Arrows ===== */
.arrow-btn{
  width:44px;height:38px;border-radius:10px;
  border:0;cursor:pointer;
  background:linear-gradient(180deg,#111638,#071025);
  color:white;font-weight:800;
  transition:.15s
}
.arrow-btn:hover{transform:translateY(-3px)}

/* ===== Grid ===== */
.grid{
  margin-top:26px;
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
  gap:18px
}
.card{
  position:relative;
  padding:16px;border-radius:14px;
  background:linear-gradient(180deg,rgba(255,255,255,.03),transparent);
  border:1px solid rgba(255,255,255,.05);
  transition:.18s
}
.card:hover{transform:translateY(-6px)}
.card:hover .top-badge{opacity:1;transform:scale(1)}

/* ===== Badge (FIXED) ===== */
.top-badge{
  position:absolute;left:12px;top:12px;
  padding:4px 8px;
  font-size:12px;font-weight:800;
  border-radius:8px;
  background:linear-gradient(90deg,var(--pink1),var(--pink2));
  color:#071023;
  opacity:0;
  transform:scale(.85);
  transition:.18s;
  pointer-events:none
}

/* ===== Buttons ===== */
.actions{display:flex;gap:10px;margin-top:14px}
.btn-view{
  flex:1;padding:10px;border-radius:10px;
  border:0;cursor:pointer;font-weight:700;
  background:linear-gradient(90deg,#0ea5e9,#7c3aed);
  color:white
}
.btn-dl{
  flex:1;padding:10px;border-radius:10px;
  background:linear-gradient(90deg,var(--pink1),var(--pink2));
  color:#071023;font-weight:700;
  text-decoration:none;display:flex;align-items:center;justify-content:center
}
</style>
</head>
<body>

<div class="wrap">

  <div class="top">
    <img src="avatar.png" class="avatar">
    <div class="title">
      <h1>CH·ªêN H·ªåC T·∫¨P</h1>
      <p>Code by KienDev ‚Äî Xem & T·∫£i t√†i li·ªáu</p>
    </div>
    <div class="controls">
      <input id="q" class="search" placeholder="T√¨m m√£ ƒë·ªÅ (t√πy ch·ªçn)">
    </div>
  </div>

  <!-- Categories -->
  <div class="section-row" id="categories">
    <div class="pill active" data-cat="all">T·∫•t c·∫£</div>
    <div class="pill" data-cat="recent">M·ªõi nh·∫•t</div>
    <div class="pill" data-cat="10">L·ªõp 10</div>
    <div class="pill" data-cat="11">L·ªõp 11</div>
    <div class="pill" data-cat="12">L·ªõp 12</div>
  </div>

  <!-- Recent -->
  <div class="recent-wrap">
    <div class="recent-head">
      <div><b>File g·∫ßn ƒë√¢y</b><br><span style="color:var(--muted);font-size:13px">6 file m·ªõi up ‚Äî 2 file / l·ªõp</span></div>
      <div>
        <button class="arrow-btn" id="prev">‚óÄ</button>
        <button class="arrow-btn" id="next">‚ñ∂</button>
      </div>
    </div>
    <div class="recent-track-wrap">
      <div id="recentTrack" class="recent-track"></div>
    </div>
  </div>

  <!-- Grid -->
  <div id="grid" class="grid"></div>

</div>

<script>
const owner="kientrng",repo="pages",folder="files";
const api=`https://api.github.com/repos/${owner}/${repo}/contents/${folder}`;

const grid=document.getElementById("grid");
const recentTrack=document.getElementById("recentTrack");
const categories=document.getElementById("categories");
const q=document.getElementById("q");

let all=[],pageCat="all",offset=0;

/* helpers */
const clean=n=>n.replace(/\.(docx?|pdf|png|jpe?g)$/i,"");
function parse(n){
  const p=clean(n).split("-");
  return{cls:p[0],num:p[1],title:p.slice(2).join("-")||p[1]}
}
function sortDesc(a,b){
  return b.parsed.cls-a.parsed.cls||b.parsed.num-a.parsed.num
}

/* load */
fetch(api).then(r=>r.json()).then(d=>{
  all=d.filter(f=>f.type==="file").map(f=>({...f,parsed:parse(f.name)}));
  buildRecent();
  renderGrid(); // ‚úÖ FIX: render ngay khi load
});

/* recent */
function buildRecent(){
  const pick=cls=>all.filter(f=>f.parsed.cls==cls).sort(sortDesc).slice(0,2);
  const recent=[...pick(12),...pick(11),...pick(10)];
  recentTrack.innerHTML="";
  recent.forEach(f=>{
    recentTrack.innerHTML+=`
      <div class="recent-card">
        <b>${f.parsed.cls}-${f.parsed.num}-${f.parsed.title}</b>
        <div style="color:var(--muted);margin-top:6px">${f.name}</div>
        <div class="actions">
          <button class="btn-view" onclick="openView('${f.download_url}','${f.name}')">üëÅ Xem</button>
          <a class="btn-dl" href="${f.download_url}" download>‚¨á T·∫£i</a>
        </div>
      </div>`;
  });
}

/* grid */
function renderGrid(){
  let list=[...all];
  if(pageCat==="recent") list.sort(sortDesc);
  if(["10","11","12"].includes(pageCat)) list=list.filter(f=>f.parsed.cls==pageCat);
  const k=q.value.toLowerCase();
  if(k) list=list.filter(f=>f.name.toLowerCase().includes(k));

  grid.innerHTML="";
  list.forEach(f=>{
    grid.innerHTML+=`
      <div class="card">
        <div class="top-badge">${f.parsed.cls}</div>
        <b>${f.parsed.cls}-${f.parsed.num}-${f.parsed.title}</b>
        <div style="color:var(--muted);margin-top:6px">${f.name}</div>
        <div class="actions">
          <button class="btn-view" onclick="openView('${f.download_url}','${f.name}')">üëÅ Xem</button>
          <a class="btn-dl" href="${f.download_url}" download>‚¨á T·∫£i</a>
        </div>
      </div>`;
  });
}

/* events */
categories.onclick=e=>{
  const p=e.target.closest(".pill");
  if(!p)return;
  categories.querySelectorAll(".pill").forEach(x=>x.classList.remove("active"));
  p.classList.add("active");
  pageCat=p.dataset.cat;
  renderGrid();
};
q.oninput=()=>renderGrid();
document.getElementById("prev").onclick=()=>recentTrack.style.transform="translateX(0)";
document.getElementById("next").onclick=()=>recentTrack.style.transform="translateX(-300px)";

function openView(u,n){
  location.href=`view.html?file=${encodeURIComponent(u)}&name=${encodeURIComponent(n)}`
}
</script>
</body>
</html>
