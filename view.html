<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Xem tài liệu — Chốn Học Tập</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
  body{
    margin:0;
    background:#040612;
    color:white;
    font-family:Poppins;
    display:flex;
    flex-direction:column;
    height:100vh;
  }

  .top{
    padding:12px 18px;
    display:flex;align-items:center;gap:14px;
    background:rgba(255,255,255,0.03);
    border-bottom:1px solid rgba(255,255,255,0.08);
  }
  .title{
    font-size:16px;font-weight:700;
  }
  .spacer{flex:1}

  .btn{
    padding:10px 14px;border-radius:10px;font-weight:700;border:0;
    cursor:pointer;
  }
  .neon{background:linear-gradient(90deg,#7C3AED,#06B6D4);color:white;}
  .ghost{background:rgba(255,255,255,0.07);color:white;}

  .viewer{
    flex:1;overflow:hidden;
    padding:10px;
  }

  iframe{
    width:100%;
    height:100%;
    border:0;border-radius:10px;
    background:white;
  }

  @media(max-width:600px){
    .title{font-size:14px}
    .btn{padding:8px 10px}
  }
</style>
</head>
<body>

<div class="top">
  <button class="btn ghost" onclick="history.back()">⬅</button>
  <div class="title" id="docName">Đang tải...</div>
  <div class="spacer"></div>
  <button id="download" class="btn neon">⬇ Tải</button>
</div>

<div class="viewer" id="viewer">
  <div style="padding:20px;color:#9bb0d0">Đang tải tài liệu…</div>
</div>

<script src="https://unpkg.com/mammoth/mammoth.browser.min.js"></script>

<script>
const p=new URLSearchParams(location.search);
const raw=p.get("file");
const name=p.get("name")||"Tài liệu";
const v=document.getElementById("viewer");

document.getElementById("docName").innerText=decodeURIComponent(name);
document.getElementById("download").onclick=()=>{window.open(raw,"_blank")};

if(!raw){
  v.innerHTML="Không có file.";
}else{
  const ext=name.split(".").pop().toLowerCase();

  const officeURL=`https://view.officeapps.live.com/op/embed.aspx?src=${raw}`;
  const isOffice = /(doc|docx|ppt|pptx|xls|xlsx)$/i.test(ext);

  if(isOffice){
    v.innerHTML=`<iframe src="${officeURL}"></iframe>`;
  }else if(ext==="pdf"){
    v.innerHTML=`<iframe src="${raw}"></iframe>`;
  }else if(/png|jpe?g|gif|webp/.test(ext)){
    v.innerHTML=`<img src="${raw}" style="width:100%;border-radius:10px">`;
  }else{
    v.innerHTML=`<iframe src="${raw}"></iframe>`;
  }
}
</script>

</body>
</html>
